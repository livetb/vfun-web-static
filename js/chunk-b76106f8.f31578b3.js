(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b76106f8"],{"09bd":function(e,t,n){"use strict";var a=n("dcd7"),r=n.n(a);r.a},"1c1e":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chat-home-root"},[a("div",{staticClass:"a-host"},[a("van-overlay",{staticClass:"loading-overlay",attrs:{show:e.showLoadingOverlay}},[a("van-loading",{attrs:{size:"24px",color:"#1989fa",vertical:""}},[e._v("Loading...")])],1),e.curHost.avatar?a("div",{staticClass:"avatar",style:{backgroundImage:"url("+e.curHost.avatar+")"}}):e._e(),a("div",{staticClass:"call-overlay"},[a("img",{staticClass:"to-call",attrs:{src:n("c4e3")},on:{click:e.randomCall}}),a("p",{staticClass:"call-text"},[e._v(e._s(e.strings.chatWithMe))])])],1),e.connectShow?a("Connect",{key:Date.now(),ref:"link",attrs:{uid:e.curHost.uid,poster:e.curHost.avatar},on:{close:e.closeConnect}}):e._e(),a("RechargeDialog",{attrs:{open:e.showRechargeTips},on:{confirm:e.rechargeNow,cancel:function(t){e.showRechargeTips=!1}}})],1)},r=[],o=(n("99af"),n("4160"),n("c975"),n("0d03"),n("d3b7"),n("ac1f"),n("25f0"),n("5319"),n("1276"),n("159b"),n("96cf"),n("89ba")),s=(n("8a4e"),n("6e47")),i=(n("bca0"),n("543e")),c=n("8bbf"),u=n.n(c),l=n("af82"),h=n("103c"),g=n("f38b"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-popup",{staticClass:"recharge-dialog-popup",model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[n("div",{staticClass:"to-recharge-dialog"},[n("div",{staticClass:"close",on:{click:e.cancel}},[n("van-icon",{attrs:{name:"close"}})],1),n("h2",[e._v("Insufficient Coins")]),n("p",[e._v("Please Recharge to Continue Video Chat")]),n("div",{staticClass:"button"},[n("div",{on:{click:e.confirm}},[e._v("Recharge now")])])])])},p=[],d=(n("87d0"),n("e41f"));u.a.use(d["a"]);var m={props:["open"],methods:{confirm:function(){this.$emit("confirm")},cancel:function(){this.$emit("cancel")}}},v=m,w=(n("09bd"),n("2877")),b=Object(w["a"])(v,f,p,!1,null,null,null),y=b.exports,R=n("260b"),k=(n("ea7b"),n("1c46")),x=n.n(k);u.a.use(s["a"]).use(i["a"]);var C={components:{Connect:g["a"],RechargeDialog:y},data:function(){return{strings:Object(h["a"])(),page:1,chats:[],refreshing:!1,loading:!1,finished:!0,profile:{},lastDBBanner:0,connectShow:!1,curHost:{},alreadyLogin:!1,showLoadingOverlay:!0,fromLivetube:null,ruid:Math.random().toString().substr(2)}},created:function(){console.log("Home Created");var e=JSON.parse(localStorage.getItem("profile")||"{}"),t=localStorage.getItem("token");e.uid&&t?this.loginSuccess():this.startMuteLogin(),this.handleFrom()},methods:{handleFrom:function(){var e=this.getUrlparam("from"),t=this.getUrlparam("uid");console.log("HandleFrom: ",e,t),"livetube"===e&&t&&(this.curHost.uid=t,this.fromLivetube=t)},tracking:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=JSON.parse(localStorage.getItem("profile")||"{}"),n=JSON.parse(localStorage.getItem("trackInfo")||"{}"),t.uid&&n.source){e.next=5;break}return console.log("no trackinfo => ",t,n),e.abrupt("return");case 5:return e.next=7,l["p"](t.uid,n.source,n.refby);case 7:a=e.sent,r=a.status,o=a.data,console.log("Tracking: ",r," => ",o);case 11:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),anonymousLogin:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,o,s,i,c,u,h,g,f,p,d,m,v,w,b,y,k,C;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Date.now(),a=4,r=R["a"].auth().languageCode||"cn",o=306,s=t.photoURL,i=t.email,c=t.uid,u=t.displayName,h=c,g=6,f=c,p=x.a.createHash("md5"),d="fjsihWdgr;_#78JI9&)!kjGHRERGRFeu342",m=p.update(h+n+d).digest("hex"),v={appId:o,loginId:h,thirdType:g,deviceCode:f,deviceType:a,requestTime:n,sign:m,regionCode:r,nickName:u,avatar:s,email:i},e.next=14,l["g"](v);case 14:w=e.sent,b=w.status,y=w.data,0===b&&(k=y.token,C=y.user,localStorage.setItem("token",k),localStorage.setItem("profile",JSON.stringify(C)));case 18:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),loginSuccess:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t||(t=(new Date).toString()),console.log("AlreadyLogin ï¼š",t),this.alreadyLogin=!0;case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),startMuteLogin:function(){var e=this;R["a"].auth().signInAnonymously().then(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=n.user,console.log("signInAnonymously",a),t.next=4,e.anonymousLogin(a);case 4:return t.next=6,e.loginSuccess();case 6:e.tracking();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.showLoginOverlay=!1,e.$toast(t.message)}))},closeConnect:function(){this.connectShow=!1},showRecharge:function(){Date.now()-this.lastDBBanner<1e3&&(this.$router.push("/recharge?showInfo"),console.log("Router push recharge")),this.lastDBBanner=Date.now()},moreToPersonal:function(){this.$router.push("/recharge")},getUrlparam:function(e,t){t||(t=window.location.href);var n=t.indexOf("?");if(n<0)return null;t=t.substr(n+1);var a=t.split("&"),r=null;return a.forEach((function(t){var n=t.split("=");n[0]!==e||(r=n[1])})),r},countAccess:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=JSON.parse(localStorage.getItem("trackInfo")||"{}"),n=JSON.parse(localStorage.getItem("profile")||"{}").uid,t.source||(t.source=t.appID||305),t.refby||(t.refby=t.appID||305),e.next=6,l["r"](n,t.source,t.refby);case 6:a=e.sent,r=a.status,o=a.msg,console.log("CountAccess: ",r,o);case 10:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),loadData:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,o,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["f"](this.ruid,this.page);case 2:t=e.sent,n=t.data,a=t.status,this.refreshing=!1,this.loading=!1,0===a&&(r=n.records,o=n.total,1===this.page?this.chats=r||[]:this.chats=this.chats.concat(r||[]),this.chats.length>=o?this.finished=!0:this.finished=!1),s=~~(Math.random()*this.chats.length),this.curHost=this.chats[s],i=window.location.href,this.fromLivetube?this.curHost.uid=this.fromLivetube:/inTest/gi.test(i)&&(this.curHost.uid=0xbbaca5f2c1a6c);case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onLoad:function(){this.page=this.page+1,this.loadData()},onRefresh:function(){this.page=1,this.loadData()},goChatDetail:function(e){console.log("chat detail => ",e)},queryBalance:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["o"](this.profile.uid);case 2:return t=e.sent,n=t.status,a=t.data,console.log("QueryBalance => ",n,a),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),rechargeNow:function(){this.$router.push("/recharge?showInfo")},randomCall:function(){this.alreadyLogin?(this.connectShow=!0,this.showLoadingOverlay=!1):this.$toast("Please waiting a minute...")}},mounted:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.loadData();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),watch:{$route:function(e,t){console.log("Router change: ",e," => ",t),/\/login/gi.test(t.path)&&(console.log("From Login, Refresh List.",(new Date).toString()),this.chats=[],this.page=1,this.loadData(),this.$router.replace("/home"))}}},S=C,O=(n("a415"),Object(w["a"])(S,a,r,!1,null,null,null));t["default"]=O.exports},a415:function(e,t,n){"use strict";var a=n("c1a7"),r=n.n(a);r.a},c1a7:function(e,t,n){},c4e3:function(e,t,n){e.exports=n.p+"img/video-button.6fb07b13.png"},dcd7:function(e,t,n){}}]);
//# sourceMappingURL=chunk-b76106f8.f31578b3.js.map